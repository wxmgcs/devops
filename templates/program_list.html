{% extends 'base.html' %}

{% block css %}
<link href="/static/css/dataTables.bootstrap.min.css" rel="stylesheet">
{% endblock %}
{% block content %}
<div class="right_col" role="main">
    <div class="">
        <div class="clearfix"></div>

        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>程序列表</h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                <ul class="dropdown-menu" role="menu">
                                    <li><a href="#">Settings 1</a>
                                    </li>
                                    <li><a href="#">Settings 2</a>
                                    </li>
                                </ul>
                            </li>
                            <li><a class="close-link"><i class="fa fa-close"></i></a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <form class="form-horizontal form-border" method="get" action="" name="formName">

                        <div class="x_content table-responsive" style="border:none">
                            <div class="ln_solid"></div>
                            <table id="datatable" class="table table-striped table-bordered">
                                <thead>
                                <tr>
                                    <th><input type="checkbox" name="alls" onClick="selectAll('formName','id')"
                                               title="全选/反选"></th>
                                    <th>程序编号</th>
                                    <th>状态</th>
                                    <th>程序类型</th>
                                    <th>VPN编号</th>
                                    <th>IP地址</th>
                                    <th>系统类型</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for program in all_program %}
                                <tr id="{{ program.pk }}">
                                    <td><input class="icheck" type="checkbox" value="{{ program.pk }}" name="id"></td>
                                    <!--<td><a href="{% url 'server_info' %}?aid={{ program.pk }}"><i class="fa fa-envelope"></a></td>-->
                                    <td>{{ program.id }}</td>
                                    {% if program.status %}
                                    <td>{{ "运行中" }}</td>
                                    {% else %}
                                    <td>{{ "已停止" }}</td>
                                    {% endif %}

                                    {% if program.type == 1 %}
                                    <td>{{ "下单" }}</td>
                                    {% elif program.type == 2 %}
                                    <td>{{ "支付" }}</td>
                                    {% else %}
                                    <td>{{ "核单" }}</td>
                                    {% endif %}
                                    <td>{{ program.vpn_number }}</td>
                                    <td>{{ program.ip }}</td>
                                    {% if program.os_type == 1 %}
                                    <td>{{ "windows" }}</td>
                                    {% else %}
                                    <td>{{ "linux" }}</td>
                                    {% endif %}
                                    <td align="left">
                                        <ul class="nav navbar-left">
                                            <li class="dropdown">
                                                <a href="#" data-toggle="dropdown" role="button"
                                                   aria-expanded="false"><i class="fa fa-wrench"></i></a>
                                                <ul class="dropdown-menu" role="menu">
                                                    <li><a href="#">程序管理</a>
                                                    </li>
                                                    <li><a href="#">日志管理</a>
                                                    </li>
                                                    <li><a href="#">修改信息</a>
                                                    </li>
                                                    <li><a href="#">监控</a>
                                                    </li>
                                                    <li><a href="#">远程命令</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
/* 全选/反选
   formName所在form的name值
   checkboxName checkbox的name值
   注意：所有checkbox的name值必须一样
*/
var checkedAll = false;
function selectAll(formName,checkboxName){
    var form = document.all.item(formName);
    var elements = form.elements[checkboxName];
    for(var i=0;i<elements.length;i++){
        var e = elements[i];
        if(checkedAll){
            e.checked = false;
            form.alls.checked = false;
        }else{
            e.checked = true;
            form.alls.checked = true;
        }
    }
    if(checkedAll){
        checkedAll = false;
    }else{
        checkedAll = true;
    }
}
/* 检查是否有checkbox被选中
   checkbox的name值必须一样，这样才能达到全选效果
*/
function checkAll(formName,checkboxName){
    var hasCheck = false;
    var form = document.all.item(formName);
    var elements = form.elements[checkboxName];
    for(var i=0;i<elements.length;i++){
        var e = elements[i];
        if(e.checked){
            hasCheck = true;
        }
    }
    return hasCheck;
}
/* 执行操作 */
function do_action(){
    if(!checkAll("formName","id")){
        alert("请至少选择一项！");
    }
}


</script>
{% endblock %}

